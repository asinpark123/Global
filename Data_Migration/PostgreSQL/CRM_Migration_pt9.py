import psycopg
import datetime

# Connect to an existing database
# globalcore_local public schema connection
with psycopg.connect("dbname=globalcore_local user=postgres password='an!mat10N' host='localhost' port= '5432'") as conn:
    
    gfResource_glEntity = {153: 84, 25: 188, 316: 196, 228: 198, 301: 207, 324: 223, 300: 236, 18: 240, 487: 241, 415: 249, 328: 250, 225: 258, 686: 284, 121: 290, 51: 295, 171: 303, 143: 309, 708: 311, 96: 313, 54: 314, 382: 315, 42: 319, 11: 321, 115: 322, 134: 324, 15: 325, 32: 333, 469: 344, 439: 351, 29: 354, 305: 355, 66: 360, 452: 362, 85: 364, 136: 365, 663: 369, 27: 383, 108: 387, 16: 389, 33: 390, 127: 391, 253: 395, 173: 396, 106: 398, 414: 402, 257: 421, 299: 429, 52: 431, 44: 447, 730: 449, 248: 450, 242: 456, 14: 461, 160: 463, 78: 465, 138: 467, 35: 468, 204: 471, 167: 477, 128: 482, 175: 483, 43: 484, 224: 487, 536: 490, 775: 492, 37: 493, 223: 497, 168: 501, 431: 502, 101: 503, 327: 510, 372: 526, 99: 527, 681: 539, 467: 543, 6: 560, 193: 562, 65: 563, 459: 565, 187: 566, 3: 576, 435: 581, 188: 582, 104: 584, 40: 586, 148: 587, 117: 592, 61: 594, 218: 600, 105: 618, 800: 648, 112: 650, 123: 670, 288: 684, 90: 929, 323: 933, 434: 934, 340: 939, 437: 960, 384: 966, 358: 977, 464: 981, 321: 989, 468: 1006, 161: 1020, 454: 1046, 377: 1052, 429: 1064, 297: 1120, 318: 1130, 291: 1170, 484: 1193, 660: 1224, 442: 1228, 286: 1305, 126: 1405, 67: 1424, 535: 1456, 12: 1477, 333: 1489, 170: 1527, 398: 1536, 141: 1564, 19: 1567, 282: 1582, 145: 1584, 427: 1638, 335: 1649, 550: 1685, 195: 1701, 30: 1733, 292: 1776, 190: 1912, 470: 1948, 1: 1970, 2: 1971, 4: 1972, 5: 1973, 7: 1974, 8: 1975, 9: 1976, 10: 1977, 13: 1978, 17: 1979, 20: 1980, 21: 1981, 22: 1982, 23: 1983, 24: 1984, 26: 1985, 28: 1986, 31: 1987, 34: 1988, 36: 1989, 38: 1990, 39: 1991, 41: 1992, 45: 1993, 46: 1994, 47: 1995, 48: 1996, 49: 1997, 50: 1998, 53: 1999, 55: 2000, 56: 2001, 57: 2002, 58: 2003, 59: 2004, 60: 2005, 62: 2006, 63: 2007, 64: 2008, 68: 2009, 69: 2010, 70: 2011, 71: 2012, 72: 2013, 73: 2014, 74: 2015, 75: 2016, 76: 2017, 77: 2018, 79: 2019, 80: 2020, 81: 2021, 82: 2022, 83: 2023, 84: 2024, 86: 2025, 87: 2026, 88: 2027, 89: 2028, 91: 2029, 92: 2030, 93: 2031, 94: 2032, 95: 2033, 97: 2034, 98: 2035, 100: 2036, 102: 2037, 103: 2038, 107: 2039, 109: 2040, 110: 2041, 111: 2042, 113: 2043, 114: 2044, 116: 2045, 118: 2046, 119: 2047, 120: 2048, 122: 2049, 124: 2050, 125: 2051, 129: 2052, 130: 2053, 131: 2054, 132: 2055, 133: 2056, 135: 2057, 137: 2058, 139: 2059, 140: 2060, 142: 2061, 144: 2062, 146: 2063, 147: 2064, 154: 2065, 155: 2066, 156: 2067, 157: 2068, 158: 2069, 159: 2070, 162: 2071, 163: 2072, 164: 2073, 165: 2074, 166: 2075, 169: 2076, 172: 2077, 174: 2078, 176: 2079, 177: 2080, 178: 2081, 179: 2082, 181: 2083, 182: 2084, 183: 2085, 184: 2086, 185: 2087, 186: 2088, 189: 2089, 191: 2090, 192: 2091, 194: 2092, 196: 2093, 197: 2094, 198: 2095, 199: 2096, 200: 2097, 201: 2098, 202: 2099, 203: 2100, 205: 2101, 206: 2102, 207: 2103, 208: 2104, 209: 2105, 210: 2106, 211: 2107, 212: 2108, 213: 2109, 214: 2110, 215: 2111, 216: 2112, 217: 2113, 219: 2114, 220: 2115, 221: 2116, 222: 2117, 226: 2118, 227: 2119, 229: 2120, 230: 2121, 231: 2122, 232: 2123, 233: 2124, 234: 2125, 235: 2126, 236: 2127, 237: 2128, 238: 2129, 239: 2130, 240: 2131, 241: 2132, 243: 2133, 244: 2134, 245: 2135, 246: 2136, 247: 2137, 249: 2138, 250: 2139, 251: 2140, 252: 2141, 254: 2142, 255: 2143, 256: 2144, 258: 2145, 259: 2146, 260: 2147, 261: 2148, 262: 2149, 263: 2150, 264: 2151, 265: 2152, 266: 2153, 280: 2154, 281: 2155, 283: 2156, 284: 2157, 285: 2158, 287: 2159, 290: 2160, 293: 2161, 294: 2162, 295: 2163, 296: 2164, 298: 2165, 302: 2166, 303: 2167, 304: 2168, 306: 2169, 307: 2170, 308: 2171, 309: 2172, 310: 2173, 311: 2174, 312: 2175, 313: 2176, 314: 2177, 315: 2178, 317: 2179, 319: 2180, 320: 2181, 322: 2182, 325: 2183, 326: 2184, 329: 2185, 330: 2186, 331: 2187, 332: 2188, 334: 2189, 336: 2190, 337: 2191, 338: 2192, 339: 2193, 341: 2194, 342: 2195, 343: 2196, 344: 2197, 345: 2198, 346: 2199, 347: 2200, 348: 2201, 349: 2202, 350: 2203, 351: 2204, 352: 2205, 353: 2206, 354: 2207, 355: 2208, 356: 2209, 357: 2210, 359: 2211, 360: 2212, 361: 2213, 362: 2214, 363: 2215, 364: 2216, 365: 2217, 366: 2218, 367: 2219, 368: 2220, 369: 2221, 370: 2222, 371: 2223, 373: 2224, 374: 2225, 375: 2226, 376: 2227, 378: 2228, 379: 2229, 380: 2230, 381: 2231, 383: 2232, 385: 2233, 386: 2234, 387: 2235, 388: 2236, 389: 2237, 390: 2238, 391: 2239, 392: 2240, 393: 2241, 394: 2242, 395: 2243, 396: 2244, 397: 2245, 399: 2246, 400: 2247, 401: 2248, 402: 2249, 404: 2250, 405: 2251, 406: 2252, 407: 2253, 408: 2254, 409: 2255, 410: 2256, 411: 2257, 417: 2258, 418: 2259, 419: 2260, 420: 2261, 421: 2262, 422: 2263, 428: 2264, 430: 2265, 433: 2266, 436: 2267, 438: 2268, 441: 2269, 444: 2270, 445: 2271, 446: 2272, 447: 2273, 448: 2274, 449: 2275, 450: 2276, 451: 2277, 453: 2278, 455: 2279, 456: 2280, 457: 2281, 458: 2282, 460: 2283, 461: 2284, 462: 2285, 463: 2286, 465: 2287, 466: 2288, 471: 2289, 472: 2290, 473: 2291, 474: 2292, 475: 2293, 476: 2294, 477: 2295, 478: 2296, 479: 2297, 480: 2298, 481: 2299, 482: 2300, 483: 2301, 486: 2302, 489: 2303, 490: 2304, 491: 2305, 492: 2306, 493: 2307, 494: 2308, 495: 2309, 496: 2310, 497: 2311, 498: 2312, 500: 2313, 501: 2314, 502: 2315, 503: 2316, 504: 2317, 505: 2318, 506: 2319, 507: 2320, 508: 2321, 511: 2322, 512: 2323, 513: 2324, 514: 2325, 517: 2326, 518: 2327, 519: 2328, 520: 2329, 521: 2330, 522: 2331, 523: 2332, 524: 2333, 525: 2334, 526: 2335, 527: 2336, 528: 2337, 529: 2338, 530: 2339, 531: 2340, 532: 2341, 533: 2342, 534: 2343, 540: 2344, 541: 2345, 542: 2346, 543: 2347, 544: 2348, 545: 2349, 546: 2350, 547: 2351, 548: 2352, 549: 2353, 551: 2354, 552: 2355, 553: 2356, 554: 2357, 555: 2358, 556: 2359, 557: 2360, 558: 2361, 559: 2362, 560: 2363, 561: 2364, 562: 2365, 563: 2366, 564: 2367, 565: 2368, 566: 2369, 572: 2370, 574: 2371, 575: 2372, 576: 2373, 577: 2374, 578: 2375, 579: 2376, 580: 2377, 581: 2378, 583: 2379, 588: 2380, 590: 2381, 591: 2382, 592: 2383, 593: 2384, 594: 2385, 595: 2386, 596: 2387, 597: 2388, 598: 2389, 599: 2390, 600: 2391, 601: 2392, 602: 2393, 603: 2394, 604: 2395, 605: 2396, 606: 2397, 608: 2398, 610: 2399, 611: 2400, 612: 2401, 613: 2402, 614: 2403, 615: 2404, 616: 2405, 617: 2406, 618: 2407, 619: 2408, 620: 2409, 622: 2410, 623: 2411, 624: 2412, 625: 2413, 626: 2414, 627: 2415, 628: 2416, 629: 2417, 630: 2418, 631: 2419, 632: 2420, 633: 2421, 634: 2422, 635: 2423, 636: 2424, 637: 2425, 638: 2426, 639: 2427, 640: 2428, 641: 2429, 642: 2430, 643: 2431, 645: 2432, 646: 2433, 647: 2434, 648: 2435, 649: 2436, 650: 2437, 651: 2438, 652: 2439, 653: 2440, 655: 2441, 656: 2442, 657: 2443, 659: 2444, 661: 2445, 662: 2446, 664: 2447, 665: 2448, 666: 2449, 667: 2450, 668: 2451, 669: 2452, 670: 2453, 671: 2454, 672: 2455, 673: 2456, 674: 2457, 675: 2458, 676: 2459, 677: 2460, 678: 2461, 679: 2462, 680: 2463, 682: 2464, 683: 2465, 684: 2466, 685: 2467, 687: 2468, 688: 2469, 689: 2470, 691: 2471, 692: 2472, 693: 2473, 694: 2474, 695: 2475, 696: 2476, 697: 2477, 698: 2478, 700: 2479, 701: 2480, 702: 2481, 703: 2482, 704: 2483, 705: 2484, 706: 2485, 709: 2486, 710: 2487, 711: 2488, 712: 2489, 713: 2490, 714: 2491, 715: 2492, 716: 2493, 717: 2494, 718: 2495, 719: 2496, 720: 2497, 721: 2498, 722: 2499, 723: 2500, 724: 2501, 725: 2502, 726: 2503, 727: 2504, 728: 2505, 729: 2506, 731: 2507, 732: 2508, 733: 2509, 734: 2510, 735: 2511, 737: 2512, 738: 2513, 739: 2514, 740: 2515, 741: 2516, 742: 2517, 743: 2518, 744: 2519, 745: 2520, 746: 2521, 747: 2522, 748: 2523, 750: 2524, 751: 2525, 753: 2526, 754: 2527, 755: 2528, 756: 2529, 757: 2530, 759: 2531, 760: 2532, 761: 2533, 762: 2534, 763: 2535, 764: 2536, 765: 2537, 766: 2538, 768: 2539, 769: 2540, 770: 2541, 771: 2542, 772: 2543, 773: 2544, 774: 2545, 776: 2546, 777: 2547, 778: 2548, 779: 2549, 780: 2550, 782: 2551, 783: 2552, 787: 2553, 788: 2554, 789: 2555, 790: 2556, 792: 2557, 793: 2558, 795: 2559, 798: 2560, 799: 2561, 149: 2562, 150: 2563, 151: 2564, 152: 2565, 180: 2566, 276: 2567, 277: 2568, 278: 2569, 279: 2570, 289: 2571, 403: 2572, 412: 2573, 413: 2574, 416: 2575, 423: 2576, 424: 2577, 425: 2578, 426: 2579, 432: 2580, 440: 2581, 443: 2582, 485: 2583, 488: 2584, 499: 2585, 509: 2586, 510: 2587, 515: 2588, 516: 2589, 537: 2590, 538: 2591, 539: 2592, 567: 2593, 568: 2594, 569: 2595, 570: 2596, 571: 2597, 573: 2598, 582: 2599, 584: 2600, 585: 2601, 586: 2602, 587: 2603, 589: 2604, 607: 2605, 609: 2606, 621: 2607, 644: 2608, 654: 2609, 658: 2610, 690: 2611, 699: 2612, 707: 2613, 736: 2614, 749: 2615, 752: 2616, 758: 2617, 767: 2618, 781: 2619, 784: 2620, 785: 2621, 786: 2622, 794: 2623, 796: 2624, 797: 2625}

    new_entityNotes = []
    defaultTime = datetime.time(9,00)
    # Open a cursor to perform database operations
    with conn.cursor() as cur:
        # Migrating ResourceNotes into EntityNotes
        cur.execute("SELECT temp.resources_resourcenote.added_date, temp.resources_resourcenote.note, temp.resources_resourcenote.resource_id, temp.resources_resourcenote_assignee.globaluser_id FROM temp.resources_resourcenote INNER JOIN temp.resources_resourcenote_assignee ON temp.resources_resourcenote.id = temp.resources_resourcenote_assignee.resourcenote_id ORDER BY temp.resources_resourcenote.id ASC")
        result_pt9 = cur.fetchall()
        for results in result_pt9:
            datetimeCombine = datetime.datetime.combine(results[0],defaultTime)
            notes = results[1].replace("'","''")
            results_2 = gfResource_glEntity[results[2]]
            new_entityNotes += [(datetimeCombine,notes,results_2,results[3])]
        for items in new_entityNotes:
            cur.execute("INSERT INTO public.crm_gl_entitynote(created, last_modified, pinned, note, creator_id, entity_id, last_modified_by_id) VALUES('%s','%s','false','%s',%s,%s,%s)" % (items[0],items[0],items[1],items[3],items[2],items[3]))

        # print(datetimeCombine)
        print(new_entityNotes)

        # Make the changes to the database persistent
        # conn.commit()